<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Part 0: Preparing the PXE Server on Arch Linux - Dimitar Petrov</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Part 0: Preparing the PXE Server on Arch Linux" />
<meta property="og:description" content="TODO Explain the benefits of setting an PXE server in home LAN TODO Develop a graph of my home infrastructure with ditaa TODO Explain that this works only for BIOS booting
In this series I am going to demonstrate how to set up a Linux environment for power users on Arch Linux and utilize literate DevOps, using Spacemacs and Org-Babel.
Note: This step is an optional one, you can always just boot from USB stick and continue from Part 1 of the Arch Install Series" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.dimitarpetrov.com/blog/2020/07/21/part-0-preparing-the-pxe-server-on-arch-linux/" />
<meta property="article:published_time" content="2020-07-21T19:45:00+03:00" />
<meta property="article:modified_time" content="2020-07-21T19:56:00+03:00" />

		<meta itemprop="name" content="Part 0: Preparing the PXE Server on Arch Linux">
<meta itemprop="description" content="TODO Explain the benefits of setting an PXE server in home LAN TODO Develop a graph of my home infrastructure with ditaa TODO Explain that this works only for BIOS booting
In this series I am going to demonstrate how to set up a Linux environment for power users on Arch Linux and utilize literate DevOps, using Spacemacs and Org-Babel.
Note: This step is an optional one, you can always just boot from USB stick and continue from Part 1 of the Arch Install Series">
<meta itemprop="datePublished" content="2020-07-21T19:45:00&#43;03:00" />
<meta itemprop="dateModified" content="2020-07-21T19:56:00&#43;03:00" />
<meta itemprop="wordCount" content="380">



<meta itemprop="keywords" content="pxe,linux," />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Part 0: Preparing the PXE Server on Arch Linux"/>
<meta name="twitter:description" content="TODO Explain the benefits of setting an PXE server in home LAN TODO Develop a graph of my home infrastructure with ditaa TODO Explain that this works only for BIOS booting
In this series I am going to demonstrate how to set up a Linux environment for power users on Arch Linux and utilize literate DevOps, using Spacemacs and Org-Babel.
Note: This step is an optional one, you can always just boot from USB stick and continue from Part 1 of the Arch Install Series"/>

	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="Mainroad" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/placeholder.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">Mainroad</div>
					<div class="logo__tagline">Just another site</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/pages/about-page/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/">
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Part 0: Preparing the PXE Server on Arch Linux</h1>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">Dimitar Petrov</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2020-07-21T19:45:00&#43;03:00">2020-07-21</time>
	<time class="meta__text" datetime="2020-07-21T19:56:00&#43;03:00">(Last Modified: 2020-07-21)</time></div></div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents"></nav>
	</div>
</div>
<div class="content post__content clearfix">
			<!-- raw HTML omitted -->
<p><em>TODO Explain the benefits of setting an PXE server in home LAN</em>
<em>TODO Develop a graph of my home infrastructure with ditaa</em>
<em>TODO Explain that this works only for BIOS booting</em></p>
<!-- raw HTML omitted -->
<p>In this series I am going to demonstrate how to set up a Linux environment for power users on Arch Linux and utilize literate DevOps, using Spacemacs and Org-Babel.</p>
<p><em>Note: This step is an optional one, you can always just boot from USB stick and continue from Part 1 of the Arch Install Series</em></p>
<p>Let&rsquo;s configure a PXE server following the official arch linux <a href="https://wiki.archlinux.org/index.php/PXE">guide</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">ssh durden
</code></pre></div><p>Next download the latest iso file from an official repo and verify signature.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mkdir ~/archstore; cd ~/archstore
repo<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://mirror.rackspace.com/archlinux/iso/latest/&#34;</span>

latest_rel<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>curl -s $repo | perl <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>              -ne <span style="color:#e6db74">&#39;print $1 . &#34;\n&#34; if ($_ =~ /.*href=&#34;(.*)\.iso&#34;/)&#39;</span><span style="color:#66d9ef">)</span>

printf <span style="color:#e6db74">&#34;Latest Arch release: %s\n&#34;</span> $latest_rel

iso<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>latest_rel<span style="color:#e6db74">}</span>.iso
sig<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>latest_rel<span style="color:#e6db74">}</span>.iso.sig
sha1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sha1sums.txt&#34;</span>

wget --quiet <span style="color:#e6db74">${</span>repo<span style="color:#e6db74">}${</span>iso<span style="color:#e6db74">}</span>
wget --quiet <span style="color:#e6db74">${</span>repo<span style="color:#e6db74">}${</span>sig<span style="color:#e6db74">}</span>
wget --quiet <span style="color:#e6db74">${</span>repo<span style="color:#e6db74">}${</span>sha1<span style="color:#e6db74">}</span>

printf <span style="color:#e6db74">&#34;Files:\n&#34;</span>
du -sh *

shasum <span style="color:#e6db74">${</span>sha1<span style="color:#e6db74">}</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $? -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span> echo <span style="color:#e6db74">&#34;SHA1 Sums: Correct&#34;</span>; <span style="color:#66d9ef">fi</span>

sudo pacman-key -v <span style="color:#e6db74">${</span>sig<span style="color:#e6db74">}</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $? -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span> echo <span style="color:#e6db74">&#34;SIG: Verified&#34;</span>; <span style="color:#66d9ef">fi</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Latest Arch release: archlinux-2017.04.01-x86_64

Files:
479M	archlinux-2017.04.01-x86_64.iso
8.0K	archlinux-2017.04.01-x86_64.iso.sig
8.0K	sha1sums.txt

bec7a89b9f4d76f1f9fb56285fc1e164429db773  sha1sums.txt
SHA1 Sums: Correct

==&gt; Checking archlinux-2017.04.01-x86_64.iso.sig...
gpg: assuming signed data in &#39;archlinux-2017.04.01-x86_64.iso&#39;
gpg: Signature made Sat 01 Apr 2017 02:34:21 PM EEST
gpg:                using RSA key 4AA4767BBC9C4B1D18AE28B77F2D434B9741E8AC
&#34; [full]
SIG: Verified
</code></pre></div><p>Please feel free to visit <a href="https://www.archlinux.org/master-keys/">Arch Master Signing Keys</a> and make sure the signature/iso you downloaded is not compromised. There is always the possibility that you got served <a href="https://www2.cs.arizona.edu/stork/packagemanagersecurity/attacks-on-package-managers.html#explanation">Malicious Image</a>.</p>
<p>Information regarding the signature can be extracted with <code>gpg --list-packets</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">gpg --list-packets &lt; <span style="color:#e6db74">${</span>sig<span style="color:#e6db74">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">
off=0 ctb=89 tag=2 hlen=3 plen=307
:signature packet: algo 1, keyid 7F2D434B9741E8AC
	version 4, created 1491046461, md5len 0, sigclass 0x00
	digest algo 8, begin of digest 54 88
	hashed subpkt 33 len 21 (issuer fpr v4 4AA4767BBC9C4B1D18AE28B77F2D434B9741E8AC)
	hashed subpkt 2 len 4 (sig created 2017-04-01)
	subpkt 16 len 8 (issuer key ID 7F2D434B9741E8AC)
	data: [2045 bits]
</code></pre></div><p>Now let&rsquo;s mount the image and prepare the files for the PXE server</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">dt<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#34;+%Y%m%d&#34;</span><span style="color:#66d9ef">)</span>
sudo mkdir /srv/pxe
sudo mount -o loop,ro <span style="color:#e6db74">${</span>iso<span style="color:#e6db74">}</span> /mnt
sudo rsync -aAXv /mnt/ /srv/pxe &gt; rsync.log.<span style="color:#e6db74">${</span>dt<span style="color:#e6db74">}</span>
tail -3 rsync.log.<span style="color:#e6db74">${</span>dt<span style="color:#e6db74">}</span>
du -sm /srv/pxe
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">sent 500,489,449 bytes  received 1,908 bytes  11,246,996.79 bytes/sec
total size is 500,361,240  speedup is 1.00

478	/srv/pxe
</code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/pxe/" rel="tag">pxe</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/linux/" rel="tag">linux</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/blog/2020/07/21/setting-up-the-all-servers-needed-for-pxe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Setting up the all servers needed for PXE</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2020 Dimitar Petrov.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="/js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>